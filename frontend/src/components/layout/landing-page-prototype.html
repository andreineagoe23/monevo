<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monevo | Level Up Your Wealth</title>
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/geist@1.3.0/dist/fonts/geist-sans/style.css" rel="stylesheet">
    
    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        monevo: {
                            bg: '#0B0F14',
                            primary: '#1D5330', // Green
                            accent: '#E6C87A',  // Gold
                            surface: '#15191E',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                        display: ['Geist Sans', 'sans-serif'],
                    },
                    fontSize: {
                        xxs: '0.6rem',
                    },
                    animation: {
                        'fade-in': 'fadeIn 1.2s ease-out forwards',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { margin: 0; overflow: hidden; background-color: #0B0F14; color: #ffffff; }
        
        /* Custom Range Slider - Linear Style */
        input[type=range] {
            appearance: none;
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            appearance: none;
            -webkit-appearance: none;
            height: 12px;
            width: 12px;
            border-radius: 50%;
            background: #E6C87A;
            border: 2px solid #0B0F14;
            box-shadow: 0 0 0 1px #E6C87A;
            cursor: pointer;
            margin-top: -5px; /* Center thumb */
            transition: transform 0.2s ease;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 2px;
            cursor: pointer;
            background: #27272a; /* Neutral 800 */
            border-radius: 2px;
        }
        input[type=range]:focus { outline: none; }
        
        /* Glass Panels - Dark Mode */
        .glass-panel {
            background: rgba(11, 15, 20, 0.65);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 20px 40px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.05);
        }

        /* Tracker Styles */
        .point-marker {
            position: absolute; width: 0; height: 0; pointer-events: none; z-index: 10;
        }
        .point-dot {
            position: absolute; width: 6px; height: 6px; background: #E6C87A;
            border-radius: 50%; transform: translate(-50%, -50%);
            box-shadow: 0 0 15px rgba(230, 200, 122, 0.6);
        }
        .point-label {
            position: absolute; top: 10px; left: 10px;
            font-family: 'JetBrains Mono', monospace; font-size: 10px;
            color: #E6C87A;
            background: rgba(11, 15, 20, 0.8);
            padding: 4px 8px; border-radius: 4px; 
            border: 1px solid rgba(230, 200, 122, 0.2);
            white-space: nowrap; transform: translate(0, 0);
            letter-spacing: 0.05em;
        }
        .point-corner {
            position: absolute; width: 8px; height: 8px;
            border: 1px solid rgba(255,255,255,0.3); opacity: 0.5;
            transform: translate(-50%, -50%);
        }
        .pc-tl { border-width: 1px 0 0 1px; top: -6px; left: -6px; }
        .pc-br { border-width: 0 1px 1px 0; bottom: -6px; right: -6px; }

        /* SVG Connection Lines */
        #tracker-lines {
            position: absolute; inset: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5;
        }
        .svg-line {
            stroke: rgba(255, 255, 255, 0.08); stroke-width: 1; vector-effect: non-scaling-stroke;
        }
        .svg-line.active {
            stroke: rgba(230, 200, 122, 0.3); 
            stroke-dasharray: 6 4; 
            animation: dash 30s linear infinite;
        }
        @keyframes dash { to { stroke-dashoffset: -100; } }

        /* Background Gradient */
        #ambient-glow {
            position: absolute; width: 600px; height: 600px;
            background: radial-gradient(circle, rgba(29, 83, 48, 0.15) 0%, rgba(11, 15, 20, 0) 70%);
            border-radius: 50%; pointer-events: none; transform: translate(-50%, -50%);
            mix-blend-mode: screen; z-index: 0;
            transition: opacity 0.5s ease;
        }
        
        ::selection { background: #1D5330; color: #fff; }
    </style>
</head>
<body class="antialiased selection:bg-emerald-900 bg-[#0B0F14] font-sans h-screen w-screen overflow-hidden">

    <!-- Ambient Background -->
    <div id="ambient-glow"></div>

    <!-- SVG Layer for Learning Paths -->
    <svg id="tracker-lines"></svg>

    <!-- Node Labels Container -->
    <div id="trackers-container"></div>

    <!-- 3D Canvas -->
    <div id="canvas-container" class="absolute inset-0 z-0 bg-[#0B0F14]"></div>

    <!-- Main Content Layer -->
    <main class="absolute inset-0 z-20 pointer-events-none flex flex-col justify-between p-6 md:p-10">
        
        <!-- Header -->
        <header class="flex items-center justify-between animate-fade-in opacity-0" style="animation-delay: 0.1s;">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 rounded bg-gradient-to-br from-[#1D5330] to-[#0B0F14] border border-[#E6C87A]/20 flex items-center justify-center">
                    <span class="font-bold text-[#E6C87A] text-sm">M</span>
                </div>
                <div class="flex flex-col">
                    <span class="font-display font-semibold tracking-tight text-white text-sm">Monevo</span>
                    <span class="font-mono text-[10px] text-neutral-500 uppercase tracking-wider">Learning OS v2.4</span>
                </div>
            </div>
            
            <div class="hidden md:flex items-center gap-6">
                <nav class="flex gap-6 pointer-events-auto">
                    <a href="#" class="text-xs font-medium text-neutral-400 hover:text-white transition-colors">Curriculum</a>
                    <a href="#" class="text-xs font-medium text-neutral-400 hover:text-white transition-colors">Mentors</a>
                    <a href="#" class="text-xs font-medium text-neutral-400 hover:text-white transition-colors">Leaderboard</a>
                </nav>
                <button class="pointer-events-auto px-4 py-1.5 rounded-full bg-white/5 border border-white/10 hover:bg-white/10 text-xs font-medium text-white transition-all backdrop-blur-sm">
                    Sign In
                </button>
            </div>
        </header>

        <!-- Hero Text -->
        <div class="max-w-4xl mt-12 md:mt-0 animate-fade-in opacity-0" style="animation-delay: 0.3s;">
            <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-[#1D5330]/30 bg-[#1D5330]/10 mb-6 backdrop-blur-sm">
                <div class="w-1.5 h-1.5 rounded-full bg-[#E6C87A] animate-pulse"></div>
                <span class="text-xs font-mono text-[#E6C87A] tracking-wide uppercase">New: AI Financial Tutor</span>
            </div>
            
            <h1 class="font-display text-5xl md:text-7xl lg:text-8xl font-semibold tracking-tight text-white leading-[0.95] mb-6">
                Turn knowledge <br>
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-white to-neutral-500">into net worth.</span>
            </h1>
            
            <p class="font-sans text-neutral-400 text-sm md:text-base max-w-lg leading-relaxed mb-8">
                The gamified financial education platform. Connect the nodes of your financial literacy, earn XP, and unlock real-world wealth strategies.
            </p>

            <div class="flex flex-col sm:flex-row gap-4 pointer-events-auto">
                <button class="group relative px-6 py-3 bg-[#E6C87A] hover:bg-[#d4b669] text-[#0B0F14] font-medium text-sm rounded transition-all overflow-hidden">
                    <span class="relative z-10 flex items-center gap-2">
                        Start Learning Path
                        <i data-lucide="arrow-right" class="w-4 h-4 transition-transform group-hover:translate-x-1"></i>
                    </span>
                </button>
                <button class="px-6 py-3 bg-white/5 hover:bg-white/10 border border-white/10 text-white font-medium text-sm rounded transition-all backdrop-blur-sm flex items-center gap-2">
                    <i data-lucide="play-circle" class="w-4 h-4 text-neutral-400"></i>
                    Watch Demo
                </button>
            </div>
        </div>

        <!-- Spacer for mobile layout -->
        <div class="flex-grow md:hidden"></div>

        <!-- Controls / HUD -->
        <div class="flex flex-col md:flex-row items-end justify-between gap-6 animate-fade-in opacity-0" style="animation-delay: 0.5s;">
            
            <!-- Left: Stats HUD -->
            <div class="hidden md:flex gap-8 pointer-events-auto">
                <div class="flex flex-col gap-1">
                    <span class="text-[10px] uppercase tracking-wider text-neutral-500 font-mono">Current Streak</span>
                    <div class="flex items-end gap-1">
                        <span class="text-2xl font-display font-medium text-white">12</span>
                        <span class="text-xs text-neutral-500 mb-1">days</span>
                    </div>
                </div>
                <div class="w-px h-10 bg-white/10"></div>
                <div class="flex flex-col gap-1">
                    <span class="text-[10px] uppercase tracking-wider text-neutral-500 font-mono">Total XP</span>
                    <div class="flex items-end gap-1">
                        <span class="text-2xl font-display font-medium text-white">8,450</span>
                        <span class="text-xs text-[#E6C87A] mb-1">+240 today</span>
                    </div>
                </div>
            </div>

            <!-- Right: Control Panel (Monevo Engine) -->
            <div class="w-full md:w-[320px] pointer-events-auto glass-panel rounded-xl flex flex-col">
                
                <!-- Panel Header -->
                <div class="flex items-center justify-between px-4 py-3 border-b border-white/5">
                    <div class="flex items-center gap-2">
                        <i data-lucide="cpu" class="w-3.5 h-3.5 text-[#E6C87A]" stroke-width="2"></i>
                        <span class="text-xs font-medium text-neutral-200 tracking-tight">LEARNING ENGINE</span>
                    </div>
                    <div class="flex items-center gap-1.5 px-2 py-0.5 rounded bg-[#1D5330]/20 border border-[#1D5330]/30">
                        <div class="w-1 h-1 bg-[#4ade80] rounded-full animate-pulse"></div>
                        <span class="text-[9px] font-bold text-[#4ade80] uppercase tracking-wide">Live</span>
                    </div>
                </div>

                <!-- Scrollable Settings -->
                <div class="p-5 space-y-5">
                    
                    <!-- XP Flow (Speed) -->
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <label class="text-[10px] uppercase tracking-wide text-neutral-500 font-mono flex items-center gap-1.5">
                                <i data-lucide="zap" class="w-3 h-3"></i> XP Flow
                            </label>
                            <span id="val-flow" class="text-[10px] text-neutral-400 font-mono">15%</span>
                        </div>
                        <input type="range" id="input-flow" min="0" max="1.0" step="0.05" value="0.15">
                    </div>

                    <!-- Difficulty (Distortion) -->
                    <div class="space-y-2">
                        <div class="flex items-center justify-between">
                            <label class="text-[10px] uppercase tracking-wide text-neutral-500 font-mono flex items-center gap-1.5">
                                <i data-lucide="bar-chart-2" class="w-3 h-3"></i> Difficulty
                            </label>
                            <span id="val-diff" class="text-[10px] text-neutral-400 font-mono">Medium</span>
                        </div>
                        <input type="range" id="input-difficulty" min="0" max="2.0" step="0.1" value="0.6">
                    </div>

                    <!-- Grid Columns -->
                    <div class="grid grid-cols-2 gap-4 pt-1">
                        <div class="space-y-2">
                            <label class="text-[9px] uppercase tracking-wide text-neutral-500 block font-mono truncate">
                                Mastery Lvl
                            </label>
                            <input type="range" id="input-mastery" min="0.1" max="2.0" step="0.1" value="0.8">
                        </div>
                        <div class="space-y-2">
                            <label class="text-[9px] uppercase tracking-wide text-neutral-500 block font-mono truncate">
                                Focus Mode
                            </label>
                            <input type="range" id="input-focus" min="0" max="1.0" step="0.01" value="0.1">
                        </div>
                    </div>

                    <div class="h-px w-full bg-white/5"></div>

                    <!-- HUD Toggle -->
                    <div class="flex items-center justify-between pt-1">
                        <div class="flex items-center gap-2">
                            <i data-lucide="brain-circuit" class="w-3.5 h-3.5 text-neutral-400"></i>
                            <span class="text-[11px] font-medium text-neutral-300">Neural HUD</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="text-[9px] text-neutral-500 uppercase mr-1">Vis</span>
                            <input type="range" id="input-hud-vis" class="w-16" min="0" max="1" step="0.1" value="0.8">
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </main>

    <!-- Vertex Shader: Constellation Particles -->
    <script type="x-shader/x-vertex" id="vertexShader">
        uniform float uTime;
        uniform float uDistortion; // Difficulty (Chaos)
        uniform float uSize;       // Mastery (Particle Size)
        uniform float uSpread;     // Focus (Dispersal)
        uniform vec2 uMouse;

        varying float vAlpha;
        varying vec3 vPos;
        varying float vDistToCenter;

        // Simplex Noise
        vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
        vec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
        vec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }
        vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }
        float snoise(vec3 v) {
            const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
            const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
            vec3 i  = floor(v + dot(v, C.yyy) );
            vec3 x0 = v - i + dot(i, C.xxx) ;
            vec3 g = step(x0.yzx, x0.xyz);
            vec3 l = 1.0 - g;
            vec3 i1 = min( g.xyz, l.zxy );
            vec3 i2 = max( g.xyz, l.zxy );
            vec3 x1 = x0 - i1 + 1.0 * C.xxx;
            vec3 x2 = x0 - i2 + 2.0 * C.xxx;
            vec3 x3 = x0 - 1.0 + 3.0 * C.xxx;
            i = mod289(i);
            vec4 p = permute( permute( permute(
                        i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
                    + i.y + vec4(0.0, i1.y, i2.y, 1.0 ))
                    + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
            float n_ = 1.0/7.0;
            vec3  ns = n_ * D.wyz - D.xzx;
            vec4 j = p - 49.0 * floor(p * ns.z *ns.z);
            vec4 x_ = floor(j * ns.z);
            vec4 y_ = floor(j - 7.0 * x_ );
            vec4 x = x_ *ns.x + ns.yyyy;
            vec4 y = y_ *ns.x + ns.yyyy;
            vec4 h = 1.0 - abs(x) - abs(y);
            vec4 b0 = vec4( x.xy, y.xy );
            vec4 b1 = vec4( x.zw, y.zw );
            vec4 s0 = floor(b0)*2.0 + 1.0;
            vec4 s1 = floor(b1)*2.0 + 1.0;
            vec4 sh = -step(h, vec4(0.0));
            vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
            vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
            vec3 p0 = vec3(a0.xy,h.x);
            vec3 p1 = vec3(a0.zw,h.y);
            vec3 p2 = vec3(a1.xy,h.z);
            vec3 p3 = vec3(a1.zw,h.w);
            vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
            p0 *= norm.x; p1 *= norm.y; p2 *= norm.z; p3 *= norm.w;
            vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
            m = m * m;
            return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );
        }

        void main() {
            vec3 pos = position;

            // Slow, heavy liquid noise for "Finance Constellation"
            float noise = snoise(vec3(pos.x * 0.3 + uTime * 0.1, pos.y * 0.3 + uTime * 0.05, pos.z * 0.3));

            // Push particles based on noise + difficulty setting
            vec3 dir = normalize(pos);
            float expansion = smoothstep(0.0, 1.0, noise) * uDistortion;
            
            // Focus Mode: If uSpread is low, particles are tighter. If high, they scatter.
            // We invert logic from original: Low Focus (high spread value) vs High Focus (low spread)
            // But let's map uSpread directly to scatter for now.
            vec3 randomScatter = dir * noise * uSpread;

            vec3 finalPos = pos + (dir * expansion) + randomScatter;

            // Mouse interaction (Repel)
            float mouseDist = distance(uMouse * 10.0, finalPos.xy);
            float mouseForce = smoothstep(5.0, 0.0, mouseDist);
            finalPos += dir * mouseForce * 0.8;

            vec4 mvPosition = modelViewMatrix * vec4(finalPos, 1.0);
            gl_Position = projectionMatrix * mvPosition;

            // Size: Mastery (uSize) makes nodes bigger
            gl_PointSize = uSize * (35.0 / -mvPosition.z);
            
            vAlpha = 1.0; 
            vPos = finalPos;
            vDistToCenter = length(finalPos);
        }
    </script>

    <!-- Fragment Shader -->
    <script type="x-shader/x-fragment" id="fragmentShader">
        uniform vec3 uColorPrimary; // Green
        uniform vec3 uColorAccent;  // Gold
        uniform float uOpacity;

        varying float vAlpha;
        varying vec3 vPos;
        varying float vDistToCenter;

        void main() {
            // Soft Circle
            vec2 center = gl_PointCoord - vec2(0.5);
            float dist = length(center);
            if (dist > 0.5) discard;
            
            float alpha = smoothstep(0.5, 0.2, dist) * uOpacity;

            // Color mixing based on depth/position
            // Core is Gold (Wealth), Edges are Green (Growth)
            float mixFactor = smoothstep(3.0, 6.0, vDistToCenter);
            vec3 finalColor = mix(uColorAccent, uColorPrimary, mixFactor);
            
            // Make center brighter
            if(dist < 0.1) finalColor += 0.3;

            gl_FragColor = vec4(finalColor, alpha);
        }
    </script>

    <script>
        lucide.createIcons();

        // --- Configuration & State ---
        const config = {
            colors: {
                bg: 0x0B0F14,
                primary: new THREE.Color('#1D5330'),
                accent: new THREE.Color('#E6C87A')
            }
        };

        const container = document.getElementById('canvas-container');
        const ambientGlow = document.getElementById('ambient-glow');
        const trackersContainer = document.getElementById('trackers-container');
        const svgLines = document.getElementById('tracker-lines');

        // --- Scene Setup ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(config.colors.bg);
        // Deep fog for endless space feel
        scene.fog = new THREE.FogExp2(config.colors.bg, 0.03);

        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.set(0, 0, 24);

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        const constellationGroup = new THREE.Group();
        // Shift right on desktop to allow text on left
        constellationGroup.position.x = 5.0; 
        scene.add(constellationGroup);

        // --- Particle Sphere (Knowledge Constellation) ---
        const geometry = new THREE.SphereGeometry(4.5, 128, 128);
        
        const uniforms = {
            uTime: { value: 0 },
            uDistortion: { value: 0.6 },
            uSize: { value: 4.0 }, 
            uSpread: { value: 0.1 }, 
            uColorPrimary: { value: config.colors.primary },
            uColorAccent: { value: config.colors.accent },
            uOpacity: { value: 0.85 },
            uMouse: { value: new THREE.Vector2(0, 0) }
        };

        const material = new THREE.ShaderMaterial({
            vertexShader: document.getElementById('vertexShader').textContent,
            fragmentShader: document.getElementById('fragmentShader').textContent,
            uniforms: uniforms,
            transparent: true,
            depthWrite: false,
            blending: THREE.AdditiveBlending // Glowy effect
        });

        const particleSystem = new THREE.Points(geometry, material);
        constellationGroup.add(particleSystem);

        // --- Orbiting Learning Paths (Rings) ---
        const orbits = [];
        const pathsGroup = new THREE.Group();
        constellationGroup.add(pathsGroup);

        function createLearningPath(radius, type, tiltX, tiltY, speed) {
            let geo, mat;
            let opacity = 0.3; // Subtle lines
            
            if (type === 'solid') {
                geo = new THREE.TorusGeometry(radius, 0.01, 8, 100);
                mat = new THREE.MeshBasicMaterial({ color: 0xFFFFFF, transparent: true, opacity: 0.1 });
            } else if (type === 'nodes') {
                // Points along the ring representing lessons
                const pts = [];
                const count = 48;
                for(let i=0; i<count; i++) {
                    const theta = (i / count) * Math.PI * 2;
                    if(Math.random() > 0.5) { // Random gaps
                        pts.push(new THREE.Vector3(Math.cos(theta) * radius, Math.sin(theta) * radius, 0));
                    }
                }
                geo = new THREE.BufferGeometry().setFromPoints(pts);
                mat = new THREE.PointsMaterial({ color: config.colors.accent, size: 0.04, transparent: true, opacity: 0.4 });
            } else if (type === 'dashed') {
                geo = new THREE.RingGeometry(radius, radius + 0.03, 80, 1, 0, Math.PI * 2);
                mat = new THREE.MeshBasicMaterial({ color: 0x1D5330, transparent: true, opacity: 0.2, side: THREE.DoubleSide });
            }

            const mesh = type === 'nodes' ? new THREE.Points(geo, mat) : new THREE.Mesh(geo, mat);
            mesh.rotation.x = tiltX;
            mesh.rotation.y = tiltY;
            pathsGroup.add(mesh);
            
            orbits.push({
                mesh: mesh,
                baseOpacity: opacity,
                rotationSpeed: new THREE.Vector3(
                    (Math.random() - 0.5) * 0.005 * speed,
                    (Math.random() - 0.5) * 0.01 * speed,
                    0
                )
            });
        }

        createLearningPath(6.0, 'dashed', Math.PI/2.2, 0, 1);
        createLearningPath(5.5, 'nodes', 0, Math.PI/2.1, 1.5); // Vertical node ring
        createLearningPath(7.2, 'solid', Math.PI/3, Math.PI/4, 0.5);

        // --- HUD Trackers (Unlocking Nodes) ---
        const r = 4.5;
        // Points on the sphere surface
        const lessonNodes = [
            { pos: new THREE.Vector3(r*0.6, r*0.5, r*0.5), label: 'LESSON 1.4', type: 'lesson', el: null },
            { pos: new THREE.Vector3(-r*0.4, -r*0.3, r*0.7), label: 'QUIZ', type: 'quiz', el: null },
            { pos: new THREE.Vector3(0, r*0.1, r*0.9), label: 'AI_TUTOR', type: 'ai', el: null }
        ];

        lessonNodes.forEach(node => {
            const div = document.createElement('div');
            div.className = 'point-marker';
            
            // Custom styling for AI node
            const labelColor = node.type === 'ai' ? 'text-white bg-[#1D5330]' : '';
            
            div.innerHTML = `
                <div class="point-dot" ${node.type === 'ai' ? 'style="background:#4ade80; box-shadow:0 0 20px #4ade80;"' : ''}></div>
                <div class="point-corner pc-tl"></div>
                <div class="point-corner pc-br"></div>
                <div class="point-label ${labelColor}">${node.label}</div>
            `;
            trackersContainer.appendChild(div);
            node.el = div;
        });

        // Lines connecting nodes
        const lines = [];
        // Connect 0->2, 2->1
        const connections = [[0,2], [2,1]];
        connections.forEach((pair, idx) => {
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            // Second line is active (pulsing)
            line.setAttribute('class', idx === 1 ? 'svg-line active' : 'svg-line');
            svgLines.appendChild(line);
            lines.push({ el: line, p1: pair[0], p2: pair[1] });
        });

        // --- Animation Loop ---
        let time = 0;
        let flowSpeed = 0.15;
        let targetRotX = 0;
        let targetRotY = 0;
        const tempVec = new THREE.Vector3();

        // Mouse Move
        document.addEventListener('mousemove', (e) => {
            const x = (e.clientX / window.innerWidth) * 2 - 1;
            const y = -(e.clientY / window.innerHeight) * 2 + 1;
            uniforms.uMouse.value.set(x, y);
            
            // Gentle parallax
            targetRotY = x * 0.2; 
            targetRotX = y * 0.1;
        });

        function animate() {
            requestAnimationFrame(animate);
            time += 0.01 * (flowSpeed * 4.0); // Speed modifier

            // Rotate constellations slowly
            particleSystem.rotation.y += 0.002;
            particleSystem.rotation.z = Math.sin(time * 0.1) * 0.05;

            // Rotate paths
            orbits.forEach(o => {
                o.mesh.rotation.x += o.rotationSpeed.x;
                o.mesh.rotation.y += o.rotationSpeed.y;
            });

            // Smooth mouse follow for group
            constellationGroup.rotation.y += (targetRotY - constellationGroup.rotation.y) * 0.05;
            constellationGroup.rotation.x += (targetRotX - constellationGroup.rotation.x) * 0.05;

            // Float effect
            constellationGroup.position.y = Math.sin(time * 0.5) * 0.15;
            if(window.innerWidth < 768) constellationGroup.position.y += 1.0; // Move up on mobile

            // Update Trackers
            const screenPoints = [];
            lessonNodes.forEach(node => {
                tempVec.copy(node.pos);
                // Apply all parent rotations
                tempVec.applyEuler(particleSystem.rotation);
                tempVec.applyMatrix4(particleSystem.matrix);
                tempVec.applyMatrix4(constellationGroup.matrixWorld);
                
                tempVec.project(camera);

                const x = (tempVec.x * 0.5 + 0.5) * window.innerWidth;
                const y = (-(tempVec.y * 0.5) + 0.5) * window.innerHeight;
                screenPoints.push({x, y});

                // Move DOM element
                if (x > 0 && x < window.innerWidth && y > 0 && y < window.innerHeight) {
                   node.el.style.transform = `translate(${x}px, ${y}px)`;
                   node.el.style.opacity = 1;
                } else {
                   node.el.style.opacity = 0;
                }
            });

            // Update Lines
            lines.forEach(line => {
                const p1 = screenPoints[line.p1];
                const p2 = screenPoints[line.p2];
                line.el.setAttribute('x1', p1.x);
                line.el.setAttribute('y1', p1.y);
                line.el.setAttribute('x2', p2.x);
                line.el.setAttribute('y2', p2.y);
            });

            // Ambient Glow follows average center of activity
            const avgX = screenPoints.reduce((sum, p) => sum + p.x, 0) / screenPoints.length;
            const avgY = screenPoints.reduce((sum, p) => sum + p.y, 0) / screenPoints.length;
            
            // Lag the glow slightly
            const currentGlowX = parseFloat(ambientGlow.style.left || avgX);
            const currentGlowY = parseFloat(ambientGlow.style.top || avgY);
            ambientGlow.style.left = `${currentGlowX + (avgX - currentGlowX) * 0.05}px`;
            ambientGlow.style.top = `${currentGlowY + (avgY - currentGlowY) * 0.05}px`;

            uniforms.uTime.value = time;
            renderer.render(scene, camera);
        }
        animate();

        // --- Controls Event Listeners ---
        const getEl = id => document.getElementById(id);

        getEl('input-flow').addEventListener('input', e => {
            flowSpeed = parseFloat(e.target.value);
            getEl('val-flow').innerText = Math.round(flowSpeed * 100) + '%';
        });

        getEl('input-difficulty').addEventListener('input', e => {
            uniforms.uDistortion.value = parseFloat(e.target.value);
            const val = parseFloat(e.target.value);
            getEl('val-diff').innerText = val < 0.5 ? 'Easy' : (val < 1.0 ? 'Medium' : 'Hard');
        });

        getEl('input-mastery').addEventListener('input', e => {
            const val = parseFloat(e.target.value);
            // Higher mastery = bigger particles
            uniforms.uSize.value = val * 3.0 + 2.0; 
        });

        getEl('input-focus').addEventListener('input', e => {
            const val = parseFloat(e.target.value);
            // Focus input 0->1. Spread logic: 1.0 focus = 0.0 spread.
            uniforms.uSpread.value = (1.0 - val) * 0.5; 
        });

        getEl('input-hud-vis').addEventListener('input', e => {
            const val = parseFloat(e.target.value);
            trackersContainer.style.opacity = val;
            svgLines.style.opacity = val;
        });

        // --- Resize Handler ---
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            
            if(window.innerWidth < 768) {
                constellationGroup.position.x = 0;
            } else {
                constellationGroup.position.x = 5.0;
            }
        });

        // Initial check
        if(window.innerWidth < 768) {
            constellationGroup.position.x = 0;
        }

    </script>

</body></html>